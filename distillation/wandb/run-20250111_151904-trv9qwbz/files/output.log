Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Starting training from scratch.
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name    | Type         | Params | Mode
-------------------------------------------------
0 | student | ModelWrapper | 23.5 M | train
1 | teacher | DINOv2ViT    | 1.1 B  | train
2 | loss_fn | CompoundLoss | 0      | train
3 | loss_0  | ScaleKD      | 141 M  | train
-------------------------------------------------
165 M     Trainable params
1.1 B     Non-trainable params
1.3 B     Total params
5,207.431 Total estimated model params size (MB)
786       Modules in train mode
0         Modules in eval mode
Epoch 0:   0%|                                                                                                        | 0/1830 [00:00<?, ?it/s]{'spatial_loss': tensor(308.2529, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.8835, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(-0.0034, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(513.1364, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|                                                                                     | 1/1830 [00:05<2:46:05,  0.18it/s, v_num=8]{'spatial_loss': tensor(308.4281, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.8199, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(-0.0040, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(513.2480, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|                                                                                     | 2/1830 [00:06<1:36:20,  0.32it/s, v_num=8]{'spatial_loss': tensor(306.9029, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.8233, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0010, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(511.7262, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▏                                                                                    | 3/1830 [00:07<1:12:27,  0.42it/s, v_num=8]{'spatial_loss': tensor(305.2120, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7065, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0065, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(509.9185, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▏                                                                                    | 4/1830 [00:07<1:00:26,  0.50it/s, v_num=8]{'spatial_loss': tensor(303.9987, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7358, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0104, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(508.7346, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▏                                                                                      | 5/1830 [00:08<53:13,  0.57it/s, v_num=8]{'spatial_loss': tensor(303.1758, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7379, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0131, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(507.9136, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▎                                                                                      | 6/1830 [00:09<48:24,  0.63it/s, v_num=8]{'spatial_loss': tensor(303.3725, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.8577, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0125, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(508.2302, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▎                                                                                      | 7/1830 [00:10<45:02,  0.67it/s, v_num=8]{'spatial_loss': tensor(303.2773, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7060, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0128, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(507.9834, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▍                                                                                      | 8/1830 [00:11<42:27,  0.72it/s, v_num=8]{'spatial_loss': tensor(301.2990, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7103, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0192, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(506.0093, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   0%|▍                                                                                      | 9/1830 [00:12<40:30,  0.75it/s, v_num=8]{'spatial_loss': tensor(300.0505, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7979, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0233, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(504.8484, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▍                                                                                     | 10/1830 [00:12<38:55,  0.78it/s, v_num=8]{'spatial_loss': tensor(298.2180, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7952, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0292, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(503.0131, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▌                                                                                     | 11/1830 [00:13<37:37,  0.81it/s, v_num=8]{'spatial_loss': tensor(298.5876, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7775, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0280, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(503.3651, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▌                                                                                     | 12/1830 [00:14<36:29,  0.83it/s, v_num=8]{'spatial_loss': tensor(297.3322, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7326, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0321, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(502.0648, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▌                                                                                     | 13/1830 [00:15<35:32,  0.85it/s, v_num=8]{'spatial_loss': tensor(296.8744, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7233, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0336, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(501.5976, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▋                                                                                     | 14/1830 [00:16<34:43,  0.87it/s, v_num=8]{'spatial_loss': tensor(293.7012, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.6536, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0439, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(498.3549, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▋                                                                                     | 15/1830 [00:16<34:02,  0.89it/s, v_num=8]{'spatial_loss': tensor(291.3068, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7059, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0517, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(496.0127, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▊                                                                                     | 16/1830 [00:17<33:25,  0.90it/s, v_num=8]{'spatial_loss': tensor(291.1477, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.6443, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0523, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(495.7920, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▊                                                                                     | 17/1830 [00:18<32:52,  0.92it/s, v_num=8]{'spatial_loss': tensor(288.7013, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7110, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0602, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(493.4122, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▊                                                                                     | 18/1830 [00:19<32:25,  0.93it/s, v_num=8]{'spatial_loss': tensor(284.9052, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.6295, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0726, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(489.5347, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▉                                                                                     | 19/1830 [00:20<31:58,  0.94it/s, v_num=8]{'spatial_loss': tensor(284.9805, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.6615, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0723, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(489.6420, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▉                                                                                     | 20/1830 [00:20<31:34,  0.96it/s, v_num=8]{'spatial_loss': tensor(282.8740, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.6023, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0792, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(487.4763, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|▉                                                                                     | 21/1830 [00:21<31:12,  0.97it/s, v_num=8]{'spatial_loss': tensor(282.3393, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.7013, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0809, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(487.0406, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|█                                                                                     | 22/1830 [00:22<30:52,  0.98it/s, v_num=8]{'spatial_loss': tensor(280.2377, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.5528, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0878, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(484.7905, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|█                                                                                     | 23/1830 [00:23<30:34,  0.99it/s, v_num=8]{'spatial_loss': tensor(278.5103, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.4207, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0934, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(482.9310, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|█▏                                                                                    | 24/1830 [00:24<30:16,  0.99it/s, v_num=8]{'spatial_loss': tensor(277.0264, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.5438, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0982, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(481.5702, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|█▏                                                                                    | 25/1830 [00:24<30:01,  1.00it/s, v_num=8]{'spatial_loss': tensor(278.5435, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.4295, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.0933, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(482.9730, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|█▏                                                                                    | 26/1830 [00:25<29:48,  1.01it/s, v_num=8]{'spatial_loss': tensor(275.5118, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.4066, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.1032, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(479.9184, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   1%|█▎                                                                                    | 27/1830 [00:26<29:35,  1.02it/s, v_num=8]{'spatial_loss': tensor(275.2104, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.3112, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.1041, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(479.5216, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   2%|█▎                                                                                    | 28/1830 [00:27<29:23,  1.02it/s, v_num=8]{'spatial_loss': tensor(272.7910, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.1759, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.1120, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(476.9669, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   2%|█▎                                                                                    | 29/1830 [00:28<29:11,  1.03it/s, v_num=8]{'spatial_loss': tensor(271.6148, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.1705, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.1158, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(475.7853, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   2%|█▍                                                                                    | 30/1830 [00:29<29:01,  1.03it/s, v_num=8]{'spatial_loss': tensor(275.0160, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.2259, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.1048, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(479.2419, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   2%|█▍                                                                                    | 31/1830 [00:29<28:51,  1.04it/s, v_num=8]{'spatial_loss': tensor(269.8147, device='cuda:0', grad_fn=<MulBackward0>), 'frequency_loss': tensor(204.0104, device='cuda:0', grad_fn=<MulBackward0>), 'cosine_similarity': tensor(0.1217, device='cuda:0', grad_fn=<MeanBackward0>), 'loss': tensor(473.8251, device='cuda:0', grad_fn=<AddBackward0>)}
Epoch 0:   2%|█▌                                                                                    | 32/1830 [00:30<28:40,  1.04it/s, v_num=8]

Detected KeyboardInterrupt, attempting graceful shutdown ...
